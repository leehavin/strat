<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:prism="http://prismlibrary.com/"
			 xmlns:conv="using:Strat.Shared.Converters"
			 xmlns:vm="using:Strat.Module.Identity.ViewModels"
			 mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="600"
			 x:Class="Strat.Module.Identity.Views.User"
			 x:DataType="vm:UserViewModel"
			 prism:ViewModelLocator.AutoWireViewModel="True">

	<UserControl.Resources>
		<conv:StatusConverter x:Key="StatusConverter"/>
		<conv:StatusToBackgroundConverter x:Key="StatusToBackgroundConverter"/>
		<conv:StatusToForegroundConverter x:Key="StatusToForegroundConverter"/>
	</UserControl.Resources>

	<Grid RowDefinitions="Auto, *" Margin="20">
		<!-- Search Bar - 应用设计系统 -->
		<Border Padding="16" 
				Background="#2D3748" 
				CornerRadius="{DynamicResource Radius_M}" 
				Margin="0,0,0,12" 
				BorderBrush="#4A5568" 
				BorderThickness="1">
			<StackPanel Orientation="Horizontal" Spacing="{DynamicResource Spacing_M}">
				<TextBox Width="150" 
						 Text="{Binding SearchModel.Name}" 
						 Watermark="请输入用户名"
						 Height="{DynamicResource Height_Input_M}"
						 FontSize="{DynamicResource FontSize_Base}"/>
				<TextBox Width="150" 
						 Text="{Binding SearchModel.Account}" 
						 Watermark="请输入账号"
						 Height="{DynamicResource Height_Input_M}"
						 FontSize="{DynamicResource FontSize_Base}"/>
				<TextBox Width="150" 
						 Text="{Binding SearchModel.Telephone}" 
						 Watermark="请输入手机号"
						 Height="{DynamicResource Height_Input_M}"
						 FontSize="{DynamicResource FontSize_Base}"/>
				<Button Content="查询" 
						Command="{Binding SearchCommand}" 
						Background="#3182CE" 
						Foreground="White"
						Height="{DynamicResource Height_Button_M}"
						Padding="{DynamicResource Padding_Button_M}"
						FontSize="{DynamicResource FontSize_Button_Medium}"
						FontWeight="{DynamicResource FontWeight_Medium}"/>
				<Button Content="重置" 
						Command="{Binding ResetCommand}"
						Height="{DynamicResource Height_Button_M}"
						Padding="{DynamicResource Padding_Button_M}"
						FontSize="{DynamicResource FontSize_Button_Medium}"/>
			</StackPanel>
		</Border>

		<!-- DataGrid Area - 企业级布局 -->
		<Border Grid.Row="1" 
				Background="#2D3748" 
				CornerRadius="{DynamicResource Radius_M}" 
				Padding="0" 
				BorderBrush="#4A5568" 
				BorderThickness="1">
			<DockPanel>
				<!-- Toolbar - 标准高度和间距 -->
				<Border DockPanel.Dock="Top" 
						Padding="{DynamicResource Spacing_M}" 
						BorderBrush="#4A5568" 
						BorderThickness="0,0,0,1">
					<StackPanel Orientation="Horizontal" Spacing="{DynamicResource Spacing_S}">
						<Button Content="+ 新增用户" 
								Background="#3182CE" 
								Foreground="White"
								Height="{DynamicResource Height_Button_M}"
								Padding="{DynamicResource Padding_Button_M}"
								FontSize="{DynamicResource FontSize_Button_Medium}"
								FontWeight="{DynamicResource FontWeight_Medium}"/>
						<Button Content="批量删除" 
								Background="#E53E3E" 
								Foreground="White"
								Height="{DynamicResource Height_Button_M}"
								Padding="{DynamicResource Padding_Button_M}"
								FontSize="{DynamicResource FontSize_Button_Medium}"/>
						<Button Content="刷新" 
								Command="{Binding SearchCommand}"
								Height="{DynamicResource Height_Button_M}"
								Padding="{DynamicResource Padding_Button_M}"
								FontSize="{DynamicResource FontSize_Button_Medium}"/>
					</StackPanel>
				</Border>

				<!-- PageBar - 企业级分页信息 -->
				<Border DockPanel.Dock="Bottom" 
						Padding="{DynamicResource Spacing_M}" 
						BorderBrush="#4A5568" 
						BorderThickness="0,1,0,0">
					<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="{DynamicResource Spacing_S}">
						<TextBlock VerticalAlignment="Center" 
								   Foreground="White"
								   FontSize="{DynamicResource FontSize_Small}">
							<Run Text="共 "/>
							<Run Text="{Binding UserPaginationModel.Total}" FontWeight="{DynamicResource FontWeight_SemiBold}"/>
							<Run Text=" 条记录"/>
						</TextBlock>
					</StackPanel>
				</Border>

				<!-- DataGrid - 应用设计规范 -->
				<DataGrid ItemsSource="{Binding UserPaginationModel.Items}"
						  AutoGenerateColumns="False"
						  IsReadOnly="True"
						  CanUserSortColumns="True"
						  CanUserResizeColumns="True"
						  GridLinesVisibility="Horizontal"
						  HeadersVisibility="Column"
						  SelectionMode="Extended"
						  RowHeight="{DynamicResource Height_TableRow_Normal}"
						  FontSize="{DynamicResource FontSize_Base}"
						  x:CompileBindings="False">
					
					<!-- 列头样式 - Avalonia 11+ 语法 -->
					<DataGrid.Styles>
						<Style Selector="DataGridColumnHeader">
							<Setter Property="FontSize" Value="{DynamicResource FontSize_Base}"/>
							<Setter Property="FontWeight" Value="{DynamicResource FontWeight_Medium}"/>
							<Setter Property="Height" Value="{DynamicResource Height_TableRow_Normal}"/>
						</Style>
					</DataGrid.Styles>
					
					<DataGrid.Columns>
						<!-- 复选框列 -->
						<DataGridCheckBoxColumn Width="50"/>
						
						<!-- 用户名 -->
						<DataGridTextColumn Header="用户名" Binding="{Binding Name}" Width="120" MinWidth="80"/>
						
						<!-- 登录账号 -->
						<DataGridTextColumn Header="登录账号" Binding="{Binding Account}" Width="120" MinWidth="80"/>
						
						<!-- 组织机构 -->
						<DataGridTextColumn Header="组织机构" Binding="{Binding OrganizationName}" Width="150" MinWidth="100"/>
						
						<!-- 角色 -->
						<DataGridTextColumn Header="角色" Binding="{Binding RoleName}" Width="120" MinWidth="80"/>
						
						<!-- 手机号 -->
						<DataGridTextColumn Header="手机号" Binding="{Binding Telephone}" Width="130" MinWidth="100"/>
						
						<!-- 状态 - 企业级颜色标识 -->
						<DataGridTemplateColumn Header="状态" Width="80">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<Border Background="{Binding Status, Converter={StaticResource StatusToBackgroundConverter}}"
											CornerRadius="{DynamicResource Radius_S}"
											Padding="{DynamicResource Spacing_XS},2"
											HorizontalAlignment="Center">
										<TextBlock Text="{Binding Status, Converter={StaticResource StatusConverter}}"
												   Foreground="{Binding Status, Converter={StaticResource StatusToForegroundConverter}}"
												   FontSize="{DynamicResource FontSize_Small}"
												   FontWeight="{DynamicResource FontWeight_Medium}"
												   HorizontalAlignment="Center"/>
									</Border>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
						
						<!-- 创建时间 - 企业级必备 -->
						<DataGridTextColumn Header="创建时间" Binding="{Binding CreateTime, StringFormat='yyyy-MM-dd HH:mm'}" Width="150" MinWidth="130"/>
					</DataGrid.Columns>
				</DataGrid>
			</DockPanel>
		</Border>
	</Grid>
</UserControl>
